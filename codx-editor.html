<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="CodX Editor - Online HTML, CSS, JS Editor"
    />
    <meta name="theme-color" content="#1e1e1e" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="icon" type="image/png" href="cx.png" />
    <title>CodX Editor</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="codx-editor.css" />
  </head>
  <body>
    <header>
      <div style="display: flex; align-items: center; gap: 8px">
        <span>Auto-Run</span>
        <label class="switch" title="Toggle auto-run feature">
          <input type="checkbox" id="autoRun" checked />
          <span class="slider"></span>
        </label>
        <span>Console</span>
        <label class="switch" title="Show/hide console output">
          <input type="checkbox" id="showConsole" />
          <span class="slider"></span>
        </label>
      </div>

      <button
        id="collabBtn"
        class="run-button"
        style="margin-left: 20px"
        aria-label="Collaborate with friends"
      >
        <svg class="btn-icon" viewBox="0 0 24 24">
          <path
            d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"
          />
        </svg>
        <strong>COLLAB WITH FRIENDS</strong>
      </button>

      <button
        id="previewFullscreenBtn"
        class="run-button"
        title="Toggle Preview Fullscreen"
        aria-label="Toggle preview fullscreen mode"
      >
        <svg class="btn-icon" viewBox="0 0 24 24">
          <path
            d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"
          />
        </svg>
        <strong>FULLSCREEN</strong>
      </button>

      <button
        id="settingsBtn"
        class="run-button"
        title="Editor Settings"
        aria-label="Open editor settings"
      >
        <svg class="btn-icon" viewBox="0 0 24 24">
          <path
            d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"
          />
        </svg>
        <strong>SETTINGS</strong>
      </button>

      <button
        id="addMediaBtn"
        class="run-button"
        title="Add images, videos, or audio"
        aria-label="Add media files"
      >
        <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"
          />
        </svg>
        <strong>ADD MEDIA</strong>
      </button>

      <button
        id="fontPickerBtn"
        class="run-button"
        title="Browse and copy fonts"
        aria-label="Font picker"
      >
        <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M9.93 13.5h4.14L12 7.98zM20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-4.05 16.5l-1.14-3H9.17l-1.12 3H5.96l5.11-13h1.86l5.11 13h-2.09z"
          />
        </svg>
        <strong>FONTS</strong>
      </button>

      <div class="theme-toggle">
        <span><strong>üåô</strong></span>
        <label class="switch" title="Toggle light/dark theme">
          <input type="checkbox" id="themeToggle" />
          <span class="slider"></span>
        </label>
        <span><strong>‚òÄÔ∏è</strong></span>
      </div>
    </header>

    <div class="editor-container">
      <div class="editors">
        <div class="file-explorer">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding: 8px;
              background: var(--bg-tertiary);
              border-bottom: 1px solid var(--border-color);
            "
          >
            <strong style="color: var(--text-primary)">Files</strong>
            <button
              id="newFileBtn"
              class="run-button"
              style="padding: 4px 12px; font-size: 12px"
              aria-label="Create new file"
            >
              <i class="fa-solid fa-plus"></i> <strong>NEW FILE</strong>
            </button>
          </div>
          <div
            id="fileList"
            style="padding: 8px; overflow-x: auto; white-space: nowrap"
          >
            <!-- File list populated dynamically -->
          </div>
        </div>

        <div class="code-container">
          <div class="line-numbers" id="lineNumbers">1</div>
          <div class="editor-wrapper">
            <textarea
              id="activeEditor"
              class="active"
              aria-label="Code editor"
              autocapitalize="none"
              autocomplete="off"
              autocorrect="off"
              spellcheck="false"
            ></textarea>
            <div
              id="typingIndicator"
              style="
                display: none;
                position: absolute;
                top: 5px;
                right: 15px;
                padding: 3px 8px;
                border-radius: 4px;
                font-size: 12px;
                color: white;
                transition: opacity 0.3s ease;
                z-index: 10;
              "
            ></div>
            <!-- ADDED: Suggestion Popup -->
            <div id="suggestionPopup"></div>
          </div>
        </div>

        <div
          style="
            display: flex;
            gap: 5px;
            padding: 8px;
            justify-content: center;
            background: var(--bg-tertiary);
            border-top: 1px solid var(--border-color);
            flex-wrap: wrap;
          "
        >
          <button
            class="run-button"
            onclick="updatePreview()"
            aria-label="Run code"
          >
            <svg class="btn-icon" viewBox="0 0 24 24">
              <path d="M8 5v14l11-7z" />
            </svg>
            <strong>RUN</strong>
          </button>
          <button
            class="run-button"
            onclick="exportAsZip()"
            aria-label="Export project as ZIP"
          >
            <i class="fa-solid fa-file-zipper"></i>
            <strong>EXPORT ZIP FILE</strong>
          </button>
          <button
            class="run-button"
            onclick="importZip()"
            aria-label="Import ZIP file"
          >
            <i class="fa-solid fa-file-import"></i>
            <strong>IMPORT ZIP FILE</strong>
          </button>
          <input
            type="file"
            id="zipFileInput"
            accept=".zip"
            style="display: none"
            onchange="handleZipImport(event)"
            aria-label="ZIP file input"
          />
        </div>
      </div>

      <div class="divider"></div>

      <div class="preview">
        <iframe id="output" title="Preview output"></iframe>
        <div class="console-container" id="consoleContainer">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding: 8px;
              border-bottom: 1px solid var(--border-color);
              background: var(--bg-secondary);
            "
          >
            <strong style="color: var(--text-primary)">Console Output</strong>
            <button
              class="run-button"
              onclick="clearConsole()"
              style="padding: 4px 10px; font-size: 11px"
              aria-label="Clear console"
            >
              <i class="fa-solid fa-trash"></i> <strong>CLEAR</strong>
            </button>
          </div>
          <div
            id="consoleOutput"
            class="console-output"
            aria-label="Console output area"
          ></div>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div
      id="settingsModal"
      style="
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        align-items: center;
        justify-content: center;
        overflow-y: auto;
        padding: 20px;
      "
    >
      <div
        style="
          position: relative;
          background-color: var(--bg-secondary);
          margin: auto;
          padding: 25px;
          border: 1px solid var(--border-color);
          width: 90%;
          max-width: 600px;
          border-radius: 8px;
          max-height: 85vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeSettingsBtn"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            color: var(--text-muted);
            cursor: pointer;
            line-height: 1;
          "
          aria-label="Close settings"
          >&times;</span
        >

        <h2
          style="margin-top: 0; color: var(--text-primary); margin-bottom: 20px"
        >
          ‚öôÔ∏è Editor Settings
        </h2>

        <!-- Background Color -->
        <div style="margin-bottom: 20px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: bold;
              color: var(--text-primary);
            "
          >
            Editor Background Color:
          </label>
          <div style="display: flex; gap: 10px; align-items: center">
            <input
              type="color"
              id="editorBgColor"
              style="
                width: 60px;
                height: 40px;
                border: 2px solid var(--border-color);
                border-radius: 4px;
                cursor: pointer;
              "
              aria-label="Select background color"
            />
            <input
              type="text"
              id="editorBgColorText"
              placeholder="#000000"
              maxlength="7"
              style="
                flex: 1;
                padding: 10px;
                background: var(--bg-tertiary);
                border: 1px solid var(--border-color);
                color: var(--text-primary);
                border-radius: 4px;
                font-family: monospace;
              "
              aria-label="Background color code"
            />
          </div>
        </div>

        <!-- Text Color -->
        <div style="margin-bottom: 20px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: bold;
              color: var(--text-primary);
            "
          >
            Editor Text Color:
          </label>
          <div style="display: flex; gap: 10px; align-items: center">
            <input
              type="color"
              id="editorTextColor"
              style="
                width: 60px;
                height: 40px;
                border: 2px solid var(--border-color);
                border-radius: 4px;
                cursor: pointer;
              "
              aria-label="Select text color"
            />
            <input
              type="text"
              id="editorTextColorText"
              placeholder="#ffffff"
              maxlength="7"
              style="
                flex: 1;
                padding: 10px;
                background: var(--bg-tertiary);
                border: 1px solid var(--border-color);
                color: var(--text-primary);
                border-radius: 4px;
                font-family: monospace;
              "
              aria-label="Text color code"
            />
          </div>
        </div>

        <!-- Text Size -->
        <div style="margin-bottom: 20px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: bold;
              color: var(--text-primary);
            "
          >
            Text Size: <span id="textSizeValue">14px</span>
          </label>
          <input
            type="range"
            id="editorTextSize"
            min="10"
            max="24"
            value="14"
            step="1"
            style="width: 100%; cursor: pointer"
            aria-label="Adjust text size"
          />
        </div>

        <!-- Font Family -->
        <div style="margin-bottom: 20px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: bold;
              color: var(--text-primary);
            "
          >
            Font Family:
          </label>
          <select
            id="editorFontFamily"
            style="
              width: 100%;
              padding: 10px;
              background: var(--bg-tertiary);
              border: 1px solid var(--border-color);
              color: var(--text-primary);
              border-radius: 4px;
              cursor: pointer;
              font-size: 14px;
            "
            aria-label="Select font family"
          >
            <option value="monospace">Monospace (Default)</option>
            <option value="'Courier New', monospace">Courier New</option>
            <option value="'Consolas', monospace">Consolas</option>
            <option value="'Monaco', monospace">Monaco</option>
            <option value="'Lucida Console', monospace">Lucida Console</option>
            <option value="'Ubuntu Mono', monospace">Ubuntu Mono</option>
            <option value="'Roboto Mono', monospace">Roboto Mono</option>
            <option value="'Source Code Pro', monospace">
              Source Code Pro
            </option>
            <option value="'Fira Code', monospace">Fira Code</option>
          </select>
        </div>
        <!-- Preview Box -->
        <div style="margin-bottom: 20px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: bold;
              color: var(--text-primary);
            "
          >
            Preview:
          </label>
          <div
            id="settingsPreview"
            style="
              padding: 15px;
              border: 2px solid var(--border-color);
              border-radius: 4px;
              font-family: monospace;
              font-size: 14px;
            "
          >
            function helloWorld() {<br />
            &nbsp;&nbsp;console.log("Hello, World!");<br />
            }
          </div>
        </div>
        <!-- Action Buttons -->
        <div
          style="
            display: flex;
            gap: 10px;
            justify-content: space-between;
            flex-wrap: wrap;
          "
        >
          <button
            id="applySettings"
            class="run-button"
            style="flex: 1"
            aria-label="Apply settings"
          >
            <strong>APPLY</strong>
          </button>
          <button
            id="resetSettings"
            class="run-button"
            style="flex: 1; background: #ff5722"
            aria-label="Reset settings to default"
          >
            <strong>RESET TO DEFAULT</strong>
          </button>
        </div>
      </div>
    </div>

    <!-- Collaboration Modal -->
    <div
      id="collabModal"
      style="
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        align-items: center;
        justify-content: center;
      "
    >
      <div
        style="
          position: relative;
          background-color: var(--bg-secondary);
          margin: 15% auto;
          padding: 20px;
          border: 1px solid var(--border-color);
          width: 80%;
          max-width: 400px;
          text-align: center;
          border-radius: 8px;
        "
      >
        <span
          id="closeModalBtn"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            font-weight: bold;
            color: var(--text-muted);
            cursor: pointer;
            line-height: 1;
          "
          aria-label="Close modal"
          >&times;</span
        >
        <h3 id="modalTitle">Modal Title</h3>
        <div id="modalBody" style="margin: 20px 0"></div>
        <p
          id="errorMsg"
          style="
            color: red;
            font-weight: bold;
            margin-top: -10px;
            margin-bottom: 10px;
            display: none;
          "
        ></p>
        <div id="modalActions">
          <button id="modalDoneBtn" class="run-button">
            <strong>DONE</strong>
          </button>
        </div>
      </div>
    </div>

    <!-- Font Picker Modal -->
    <div
      id="fontPickerModal"
      style="
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        align-items: center;
        justify-content: center;
        overflow-y: auto;
        padding: 20px;
      "
    >
      <div
        style="
          position: relative;
          background-color: var(--bg-secondary);
          margin: auto;
          padding: 25px;
          border: 1px solid var(--border-color);
          width: 90%;
          max-width: 800px;
          border-radius: 8px;
          max-height: 85vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeFontPickerBtn"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            color: var(--text-muted);
            cursor: pointer;
            line-height: 1;
          "
          aria-label="Close font picker"
          >&times;</span
        >

        <h2
          style="margin-top: 0; color: var(--text-primary); margin-bottom: 10px"
        >
          üî§ Font Picker
        </h2>

        <div
          style="
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-color);
          "
        >
          <p style="margin: 0; color: var(--text-primary); font-size: 14px">
            <strong>Instructions:</strong> Click on any font below to copy its
            <code>font-family</code> code to your clipboard. Then paste it in
            your CSS!
          </p>
        </div>

        <div
          id="fontGrid"
          style="
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
          "
        >
          <!-- Fonts will be inserted here -->
        </div>
      </div>
    </div>

    <!-- Tutorial Modal -->
    <div
      id="tutorialModal"
      style="
        display: none;
        position: fixed;
        z-index: 2000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.85);
        overflow: hidden;
      "
    >
      <!-- Tutorial Highlight -->
      <div
        id="tutorialHighlight"
        style="
          position: absolute;
          border: 3px solid var(--accent-color);
          border-radius: 8px;
          box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75);
          pointer-events: none;
          transition: all 0.3s ease;
          z-index: 2001;
        "
      ></div>

      <!-- Tutorial Card -->
      <div
        id="tutorialCard"
        style="
          position: absolute;
          background: var(--bg-secondary);
          border: 2px solid var(--accent-color);
          border-radius: 12px;
          padding: 24px;
          max-width: 400px;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
          z-index: 2002;
        "
      >
        <span
          id="closeTutorialBtn"
          style="
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 24px;
            font-weight: bold;
            color: var(--text-muted);
            cursor: pointer;
            line-height: 1;
            transition: color 0.2s;
          "
          aria-label="Close tutorial"
          >&times;</span
        >

        <div style="margin-bottom: 16px">
          <i
            id="tutorialIcon"
            class="fa-solid fa-rocket"
            style="font-size: 32px; color: var(--accent-color)"
          ></i>
        </div>

        <h3
          id="tutorialTitle"
          style="
            margin: 0 0 12px 0;
            color: var(--text-primary);
            font-size: 20px;
          "
        >
          Welcome!
        </h3>

        <p
          id="tutorialDescription"
          style="
            margin: 0 0 20px 0;
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
          "
        >
          Let's take a quick tour of CodX Editor.
        </p>

        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
          "
        >
          <span
            id="tutorialProgress"
            style="color: var(--text-muted); font-size: 12px"
            >Step 1 of 10</span
          >
        </div>

        <div style="display: flex; gap: 12px">
          <button
            id="tutorialPrevBtn"
            class="run-button"
            style="flex: 1; background: var(--bg-tertiary)"
          >
            <i class="fa-solid fa-arrow-left"></i> <strong>PREV</strong>
          </button>
          <button id="tutorialNextBtn" class="run-button" style="flex: 2">
            <strong>NEXT</strong> <i class="fa-solid fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>

    <script src="codx-editor.js"></script>
  </body>
</html>
